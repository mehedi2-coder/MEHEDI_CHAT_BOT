const schedule = require('node-schedule');
const chalk = require('chalk');
const moment = require('moment-timezone');

module.exports.config = {
    name: 'autosent',
    version: '1.2.0',
    hasPermssion: 0,
    credits: 'ð— ð—²ð—µð—²ð—±ð—¶ ð—›ð—®ð˜€ð—®ð—»', // Don't Remove Credits
    description: 'Automatically sends styled hourly messages in all groups (BD Time)',
    commandCategory: 'group messenger',
    usages: '[]',
    cooldowns: 3
};

const captions = {
    0: "ðŸŒŒ à¦†à¦°à§‹ à¦à¦•à¦Ÿà¦¿ à¦¦à¦¿à¦¨ à¦¶à§‡à¦·à¥¤ à¦¨à¦¤à§à¦¨ à¦¦à¦¿à¦¨à§‡à¦° à¦¶à§à¦°à§, à¦¶à§à¦­à¦°à¦¾à¦¤à§à¦°à¦¿ à¦¸à¦¬à¦¾à¦‡à¦•à§‡!",
    1: "ðŸŒƒ à¦…à¦¨à§‡à¦• à¦¦à§‡à¦°à¦¿ à¦¹à§Ÿà§‡ à¦—à§‡à¦›à§‡, à¦˜à§à¦®à¦¿à§Ÿà§‡ à¦ªà§œà§‹ à¦¤à¦¾à§œà¦¾à¦¤à¦¾à§œà¦¿ ðŸ˜´",
    2: "ðŸ˜´ à¦¯à¦¾à¦°à¦¾ à¦œà§‡à¦—à§‡ à¦†à¦›à§‹ à¦à¦•à¦Ÿà§ à¦˜à§à¦®à¦¾à¦¨à§‹ à¦¦à¦°à¦•à¦¾à¦°!",
    3: "ðŸŒŒ à¦…à¦¨à§‡à¦• à¦°à¦¾à¦¤ à¦¹à¦²à§‹, à¦¸à¦•à¦¾à¦²à§‡à¦° à¦†à¦—à§‡ à¦¬à¦¿à¦¶à§à¦°à¦¾à¦® à¦¨à¦¾à¦“à¥¤",
    4: "ðŸŒ„ à¦‰à¦ à§‹, à¦«à¦œà¦°à§‡à¦° à¦¸à¦®à§Ÿ à¦•à¦¾à¦›à¦¾à¦•à¦¾à¦›à¦¿ ðŸ•Œ",
    5: "âœ¨ à¦†à¦œà¦¾à¦¨ à¦¹à§Ÿà§‡ à¦¯à¦¾à¦¬à§‡, à¦¸à¦¬à¦¾à¦‡ à¦¨à¦¾à¦®à¦¾à¦œà§‡à¦° à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¾à¦“ ðŸ•Œ",
    6: "â˜€ï¸ à¦¦à¦¿à¦¨ à¦¶à§à¦°à§ à¦¹à§‹à¦• à¦¬à¦°à¦•à¦¤à¦®à§Ÿ âœ¨",
    7: "ðŸŒ¸ à¦ªà§œà¦¾à¦¶à§‹à¦¨à¦¾/à¦•à¦¾à¦œ à¦¶à§à¦°à§ à¦•à¦°à¦¾à¦° à¦¸à§‡à¦°à¦¾ à¦¸à¦®à§Ÿ!",
    8: "ðŸ’¼ à¦•à¦¾à¦œà§‡ à¦®à¦¨à§‹à¦¯à§‹à¦— à¦¦à§‡à¦“à§Ÿà¦¾à¦° à¦¸à§‡à¦°à¦¾ à¦¸à¦®à§Ÿ â³",
    9: "â˜• à¦à¦• à¦•à¦¾à¦ª à¦šà¦¾/à¦•à¦«à¦¿ à¦¹à¦²à§‡ à¦­à¦¾à¦²à§‹ à¦¹à§Ÿ ðŸ˜",
    10: "ðŸŒž à¦¸à¦¬à¦¾à¦‡ à¦‰à¦¦à§à¦¯à¦®à§€ à¦¥à¦¾à¦•à§‹ðŸ’ª",
    11: "ðŸ•š à¦¦à§à¦ªà§à¦°à§‡à¦° à¦ªà§à¦°à¦¸à§à¦¤à§à¦¤à¦¿ à¦¨à¦¾à¦“ ðŸ²",
    12: "ðŸŒ¤ï¸ à¦¦à§à¦ªà§à¦°à§‡à¦° à¦¨à¦¾à¦®à¦¾à¦œ à¦“ à¦¬à¦¿à¦¶à§à¦°à¦¾à¦®à§‡à¦° à¦¸à¦®à§Ÿ ðŸ•Œ",
    13: "ðŸ› à¦—à§‹à¦¸à¦² à¦•à¦°à§‡ à¦¯à§‹à¦¹à¦°à§‡à¦° à¦¸à¦¾à¦²à¦¾à¦¤ à¦†à¦¦à¦¾à§Ÿ à¦•à¦°à§‡ à¦¨à¦¾à¦“à¥¤",
    14: "â˜€ï¸ à¦–à¦¾à¦¬à¦¾à¦° à¦–à§‡à§Ÿà§‡ à¦à¦•à¦Ÿà§ à¦¬à¦¿à¦¶à§à¦°à¦¾à¦® à¦¨à¦¿à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¾ ðŸ’ª",
    15: "ðŸŒ¤ï¸ à¦à¦•à¦Ÿà§ à¦ªà¦¾à¦“à§Ÿà¦¾à¦° à¦¨à§à¦¯à¦¾à¦ª à¦¨à¦¿à§Ÿà§‡ à¦¨à¦¿à¦¤à§‡ à¦ªà¦¾à¦°à§‹ ðŸ˜´",
    16: "ðŸŒ‡ à¦†à¦¸à¦°à§‡à¦° à¦¨à¦¾à¦®à¦¾à¦œ à¦†à¦¦à¦¾à§Ÿ à¦•à¦°à§‡ à¦¨à¦¾à¦“ ðŸ•Œ",
    17: "ðŸŒ† à¦à¦•à¦Ÿà§ à¦¹à§‡à¦à¦Ÿà§‡ à¦¶à¦°à§€à¦° à¦¹à¦¾à¦²à¦•à¦¾ à¦•à¦°à§‡ à¦¨à¦¾à¦“ ðŸš¶â€â™‚ï¸",
    18: "ðŸŒ… à¦®à¦¾à¦—à¦°à¦¿à¦¬ à¦¨à¦¾à¦®à¦¾à¦œ à¦†à¦¦à¦¾à§Ÿ à¦•à¦°à§‡ à¦¨à¦¾à¦“ ðŸ•Œ",
    19: "ðŸŒƒ à¦ªà¦°à¦¿à¦¬à¦¾à¦°à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§Ÿ à¦•à¦¾à¦Ÿà¦¾à¦“ â¤ï¸",
    20: "ðŸŒ™ à¦ªà§œà¦¾à¦¶à§‹à¦¨à¦¾ à¦¬à¦¾ à¦•à¦¾à¦œ à¦—à§à¦›à¦¿à§Ÿà§‡ à¦¨à¦¾à¦“ ðŸ“š",
    21: "ðŸŒŒ à¦‡à¦¶à¦¾à¦° à¦¨à¦¾à¦®à¦¾à¦œ à¦†à¦¦à¦¾à§Ÿ à¦•à¦°à§‡ à¦¨à¦¾à¦“ ðŸ•Œ",
    22: "ðŸŒƒ à¦°à¦¾à¦¤à§‡à¦° à¦–à¦¾à¦¬à¦¾à¦° à¦–à§‡à§Ÿà§‡ à¦¨à¦¾à¦“ ðŸ›ï¸",
    23: "ðŸŒ™ à¦˜à§à¦®à¦¿à§Ÿà§‡ à¦ªà§œà¦¾à¦° à¦­à¦¾à¦²à§‹ à¦¸à¦®à§Ÿ ðŸ˜´"
};

module.exports.onLoad = ({ api }) => {
    console.log(chalk.bold.hex("#00c300")("============ AUTOSENT COMMAND LOADED (BD TIME) ============"));

    for (let h = 0; h < 24; h++) {
        const rule = new schedule.RecurrenceRule();
        rule.tz = 'Asia/Dhaka';
        rule.hour = h;
        rule.minute = 0;

        schedule.scheduleJob(rule, () => {
            if (!global.data?.allThreadID) return;

            const nowMoment = moment().tz('Asia/Dhaka');
            const hour = nowMoment.hour();

            const message = captions[hour] || "â° à¦¸à¦®à§Ÿà§‡à¦° à¦•à¦¦à¦° à¦•à¦°à§à¦¨, à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¿ à¦®à§à¦¹à§‚à¦°à§à¦¤à¦‡ à¦®à§‚à¦²à§à¦¯à¦¬à¦¾à¦¨!";

            const finalMessage =
`â€¢â”„â”…â•â•â•ââ°ââ•â•â•â”…â”„â€¢â•®

ðŸ•’ à¦à¦–à¦¨ à¦¸à¦®à§Ÿ ${hour}:00 à¦Ÿà¦¾
${message}

ðŸ”° à¦¸à¦®à§Ÿà§‡à¦° à¦•à¦¦à¦° à¦•à¦°à§à¦¨,
ðŸ”¯ à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¿ à¦®à§à¦¹à§‚à¦°à§à¦¤à¦‡ à¦®à§‚à¦²à§à¦¯à¦¬à¦¾à¦¨!

â•°â€¢â”„â”…â•â•â•ââ°ââ•â•â•â”…â”„â€¢â•¯`;

            global.data.allThreadID.forEach(threadID => {
                api.sendMessage(finalMessage, threadID, (error) => {
                    if (error) console.error(`Failed to send message to ${threadID}:`, error);
                });
            });

            console.log(chalk.hex("#00FFFF")(`Scheduled (BDT): ${hour}:00 => ${message}`));
        });
    }
};

module.exports.run = () => {

};
